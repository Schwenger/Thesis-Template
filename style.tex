%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Names and abbreviations for in references
\crefname{definition}{Def.}{Defs.}%
\crefname{section}{Sect.}{Sect.}%
\crefname{examplex}{Exm.}{Exms.}%
\crefname{equation}{Eq.}{Eqs.}%
\crefname{proposition}{Prop.}{Props.}%
\crefname{lemma}{Lem.}{Lems.}%
\crefname{corollary}{Cor.}{Cors.}%
\crefname{theorem}{Thm.}{Thms.}%
\crefname{remark}{Rem.}{Rems.}%
\crefname{figure}{Fig.}{Figs.}%
\crefname{table}{Tbl.}{Tbls.}%
\crefname{algorithm}{Alg.}{Algs.}%
\Crefname{examplex}{Example}{Examples}%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Theorem Environments

\AtBeginEnvironment{definition}{\Needspace{3\baselineskip}}% \break if fewer than 5\baselineskip is available on page

\declaretheoremstyle[
  headfont=\bfseries,
  numbered=yes, % DONT change, will break everything for some reason.
  bodyfont=\normalfont,
  spaceabove=\topsep,
  postheadspace=1em,
  headpunct={},
  postheadhook=\defheaderline,
  prefoothook=\\*\noindent\defheaderline,
  spacebelow=.5\topsep,  
]{sepdef}

\declaretheorem[
  style=sepdef,
  title=Definition,
  refname={definition,definitions},
  Refname={Definition,Definitions},
  numberwithin=chapter
]{definition}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{remark}{Remark}[section]

\theoremstyle{definition}
\newtheorem{construction}{Construction}[chapter]
% Taken from https://tex.stackexchange.com/a/32394
\newtheorem{examplex}{Example}[section]
\newenvironment{example}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{\(\triangle\)}\examplex}
  {\popQED\endexamplex}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Allow for page breaks in long equations:
\allowdisplaybreaks{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% What should be included in the ref list

\addtoreflist{chapter}
\addtoreflist{section}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Night Mode Style

\ifthenelse{\boolean{nightmode}}{
  \pagecolor[rgb]{0.2,0.2,0.2}
  \color[rgb]{.9,.9,.9}
  \definecolor{bluekeywords}{RGB}{120, 170, 250}
  \definecolor{greentypes}{RGB}{167, 247, 101}
  \definecolor{redstrings}{RGB}{247, 211, 92}
  \definecolor{graynumbers}{rgb}{0.8, 0.8, 0.8}
  \definecolor{goldcomments}{RGB}{247, 211, 92}
  \renewcommand*\logoopacity{1}
}{
  \definecolor{bluekeywords}{rgb}{0.13, 0.13, 1}
  \definecolor{greentypes}{rgb}{0, 0.5, 0}
  \definecolor{redstrings}{RGB}{171, 114, 2}
  \definecolor{graynumbers}{rgb}{0.5, 0.5, 0.5}
  \definecolor{goldcomments}{rgb}{0.6, 0.4, 0.08}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Table styles

\newcolumntype{L}{>{\(}l<{\)}} % math-mode version of "l" column type
\newcolumntype{R}{>{\(}r<{\)}} % math-mode version of "r" column type
\newcolumntype{C}{>{\(}c<{\)}} % math-mode version of "c" column type


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Define custom language, exemplified by RTLola

\lstdefinelanguage{Lola}{
  keywords=[0]{input, output, trigger},
  keywordstyle=[0]\bfseries\color{bluekeywords},
  keywords=[1]{if, then, else, aggregate, defaults, offset},
  keywords=[2]{Int8, Int16, Int32, Int64, UInt8, UInt16, UInt32, UInt64, Bool, Float32, Float64, @1Hz, @5Hz, @10Hz, @100mHz, @1kHz},
  keywordstyle=[2]\color{greentypes},
    sensitive=false,
    comment=[l]{//},
    morecomment=[s]{/*}{*/},
    morestring=[b]',
    morestring=[b]"
}

\lstset{
    autogobble,
    language={Lola},
    columns=fullflexible,
    showspaces=false,
    showtabs=false,
    breaklines=true,
    showstringspaces=false,
    breakatwhitespace=true,
    commentstyle=\color{greencomments},
    keywordstyle=[1]\color{bluekeywords},
    stringstyle=\color{redstrings},
    numberstyle=\color{graynumbers},
    basicstyle=\ttfamily\footnotesize,
    frame=l,
    framesep=12pt,
    xleftmargin=12pt,
    tabsize=4,
    captionpos=b,
    mathescape,
}

% Language without any highlighting.
\lstdefinelanguage{none}{
  identifierstyle=
}